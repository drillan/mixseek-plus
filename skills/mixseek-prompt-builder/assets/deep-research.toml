# MixSeek PromptBuilder Configuration - Deep Research
# 複数ラウンドで検索キーワードを改善するためのプロンプト設定

[prompt_builder]
# Teamに渡すユーザプロンプトのJinja2テンプレート
# 利用可能なプレースホルダー変数:
#   - {{ user_prompt }}            : 元のユーザプロンプト
#   - {{ round_number }}           : 現在のラウンド番号（整数）
#   - {{ submission_history }}     : 過去のSubmission履歴（整形済み文字列）
#   - {{ ranking_table }}          : Leader Boardランキング情報（整形済み文字列）
#   - {{ team_position_message }}  : チーム順位メッセージ（整形済み文字列）
#   - {{ current_datetime }}       : 現在日時（ISO 8601形式、タイムゾーン付き）

team_user_prompt = """
---
現在日時: {{ current_datetime }}
---

# 概要
あなたはDeep Researchチームのリーダーとして、ユーザーから指定されたタスクに取り組みます。
複数ラウンドにわたって調査を深化させ、より質の高い情報を収集してください。

# ユーザから指定されたタスク
{{ user_prompt }}

# 現在のラウンド
ラウンド {{ round_number }} / 最大3ラウンド

{% if round_number == 1 %}
## ラウンド1: 初期調査
- まず広範な検索キーワードで情報を収集してください
- 主要な情報源とキーコンセプトを特定してください
- 次のラウンドで深掘りすべきトピックを把握してください
{% elif round_number == 2 %}
## ラウンド2: 検索キーワードの改善と深掘り
前回の調査結果を分析し、以下の改善を行ってください：

1. **キーワードの具体化**: 前回の検索で使用した一般的なキーワードを、より専門的・具体的なキーワードに置き換える
2. **同義語・関連語の活用**: 前回見つかった専門用語や関連概念を新たな検索キーワードとして使用
3. **情報の空白を埋める**: 前回の調査で不足していた観点や情報を特定し、それらに焦点を当てた検索を実施
4. **異なる視点からの検索**: 前回とは異なるアプローチ（例：学術的視点、実務的視点、最新動向など）で検索
5. **信頼性の高い情報源の深掘り**: 前回見つけた有望な情報源から、より詳細な情報を取得
{% elif round_number >= 3 %}
## ラウンド3: 最終統合と検証
これまでの調査結果を総合し、最終的な回答を作成してください：

1. **情報の検証**: 複数の情報源で裏付けが取れているか確認
2. **矛盾の解消**: 異なる情報源間の矛盾があれば、最新・最信頼の情報を優先
3. **網羅性の確認**: ユーザーの質問に対して必要な情報が揃っているか確認
4. **不足情報の補完**: まだ不足している情報があれば、ピンポイントで追加検索
5. **構造化された回答**: 収集した情報を論理的に整理し、明確な回答を作成
{% endif %}

# 過去の提出履歴
{{ submission_history }}
"""

# Evaluatorに渡すユーザプロンプトのJinja2テンプレート
evaluator_user_prompt = """
---
現在日時: {{ current_datetime }}
---
# タスク
以下のユーザプロンプトに対するエージェントの提出内容を、あなたの役割に従って評価してください。

# ユーザから指定されたタスク
{{ user_prompt }}

# 提出内容
{{ submission }}
"""

# JudgementClientに渡すユーザプロンプトのJinja2テンプレート
judgment_user_prompt = """
---
現在日時: {{ current_datetime }}
---

# タスク
以下の提出履歴に基づいて、調査の継続が必要かどうかを判定してください。

## 判定基準
- **継続が必要**: 情報が不十分、重要な観点が欠落、検索キーワードの改善余地がある
- **終了可能**: ユーザーの質問に十分な回答ができている、追加調査による改善が見込めない

# ユーザから指定されたタスク
{{ user_prompt }}

# 提出履歴
{{ submission_history }}

# リーダーボード
{{ ranking_table }}
"""
