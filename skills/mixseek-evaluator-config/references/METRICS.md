# Standard Metrics Reference

## 概要

MixSeek-Coreで使用可能な標準評価メトリクスの詳細説明です。

## メトリクス一覧

### 1. ClarityCoherence（明確性・一貫性）

**目的**: 回答の読みやすさと論理的一貫性を評価

**評価スケール**: 0-100

**評価観点**:

| 観点 | 説明 | 重み |
|------|------|------|
| 文章構造 | 段落・見出しの適切な使用 | 25% |
| 論理的流れ | 議論の展開が自然か | 30% |
| 用語の一貫性 | 同じ概念に同じ用語を使用 | 20% |
| 結論の明確さ | 結論が明確に述べられているか | 25% |

**スコアリング基準**:

| スコア範囲 | 評価 | 説明 |
|-----------|------|------|
| 90-100 | 優秀 | 非常に明確で一貫した文章 |
| 70-89 | 良好 | 概ね明確だが改善の余地あり |
| 50-69 | 普通 | 理解可能だが不明確な部分あり |
| 30-49 | 要改善 | 理解に困難を伴う |
| 0-29 | 不十分 | 論理的一貫性が欠如 |

**推奨用途**:
- 説明文・解説文の生成
- 技術ドキュメント
- 教育コンテンツ
- レポート作成

**設定例**:
```toml
[[metrics]]
name = "ClarityCoherence"
weight = 0.4
system_instruction = """
以下の観点で回答の明確性と一貫性を0-100で評価してください:
1. 文章構造の適切さ
2. 論理的な流れ
3. 用語の一貫性
4. 結論の明確さ
"""
```

---

### 2. Coverage（カバレッジ）

**目的**: 質問に対する回答の網羅性を評価

**評価スケール**: 0-100

**評価観点**:

| 観点 | 説明 | 重み |
|------|------|------|
| 質問対応 | 質問の全側面に回答しているか | 35% |
| 関連情報 | 関連する補足情報を含むか | 25% |
| 例示 | 具体例が適切に含まれるか | 20% |
| 深さ | 十分な詳細レベルか | 20% |

**スコアリング基準**:

| スコア範囲 | 評価 | 説明 |
|-----------|------|------|
| 90-100 | 完全 | 質問の全側面を網羅 |
| 70-89 | 十分 | 主要な側面をカバー |
| 50-69 | 部分的 | 一部の側面が欠落 |
| 30-49 | 不足 | 重要な情報が欠落 |
| 0-29 | 不十分 | ほとんどカバーされていない |

**推奨用途**:
- リサーチタスク
- FAQ作成
- 総合的な分析
- 調査レポート

**設定例**:
```toml
[[metrics]]
name = "Coverage"
weight = 0.35
system_instruction = """
以下の観点で回答のカバレッジを0-100で評価してください:
1. 質問の全側面への対応
2. 関連する補足情報の包含
3. 具体例の適切な使用
4. 情報の深さと詳細レベル
"""
```

---

### 3. Relevance（関連性）

**目的**: 回答が質問に対してどれだけ的確かを評価

**評価スケール**: 0-100

**評価観点**:

| 観点 | 説明 | 重み |
|------|------|------|
| 直接性 | 質問に直接回答しているか | 40% |
| 焦点 | 話題が逸れていないか | 25% |
| 簡潔性 | 不要な情報が含まれていないか | 20% |
| 文脈適合 | 質問の文脈に適しているか | 15% |

**スコアリング基準**:

| スコア範囲 | 評価 | 説明 |
|-----------|------|------|
| 90-100 | 完璧 | 質問に完全に的確 |
| 70-89 | 高い | 主に的確だが若干の脱線あり |
| 50-69 | 中程度 | 関連はあるが焦点がぼやける |
| 30-49 | 低い | 部分的にしか関連しない |
| 0-29 | 無関係 | 質問と関係ない内容 |

**推奨用途**:
- Q&A対応
- カスタマーサポート
- 検索結果評価
- チャットボット

**設定例**:
```toml
[[metrics]]
name = "Relevance"
weight = 0.5
system_instruction = """
以下の観点で回答の関連性を0-100で評価してください:
1. 質問への直接的な回答
2. 話題の焦点維持
3. 不要な情報の排除
4. 質問の文脈への適合
"""
```

---

### 4. LLMPlain（汎用LLM評価）

**目的**: カスタム評価基準に基づくLLMによる柔軟な評価

**評価スケール**: 0-100

**特徴**:

| 特徴 | 説明 |
|------|------|
| カスタマイズ性 | `system_instruction`で評価基準を完全に定義 |
| 柔軟性 | あらゆる評価観点に対応可能 |
| 専門性 | ドメイン固有の評価基準を設定可能 |

**使用シナリオ**:

- 他の標準メトリクスでカバーできない評価観点がある場合
- ドメイン固有の専門的な評価が必要な場合
- プロジェクト固有の品質基準を適用したい場合

**重要**: `LLMPlain`を使用する場合は、`system_instruction`で明確な評価基準を定義してください。指定しない場合、評価結果が不安定になる可能性があります。

**設定例**:
```toml
[[metrics]]
name = "LLMPlain"
weight = 0.4
system_instruction = """
以下の観点でセキュリティ品質を0-100で評価してください:

1. 機密情報の取り扱い（30%）
   - パスワード、APIキー等の露出がないか
   - 個人情報の適切な保護

2. 安全なコーディング実践（40%）
   - インジェクション対策
   - 入力値のバリデーション
   - エラーハンドリング

3. セキュリティベストプラクティス（30%）
   - 最新のセキュリティガイドラインへの準拠
   - 既知の脆弱性パターンの回避

各観点のスコアを重み付けして、最終スコアを算出してください。
"""
temperature = 0.0
```

**推奨用途**:
- セキュリティレビュー
- 法務・コンプライアンスチェック
- 医療・ヘルスケアドメインの品質評価
- アクセシビリティ評価

---

## メトリクス組み合わせパターン

### パターン1: バランス型（汎用）

すべてのメトリクスを均等に重視。

```toml
[[metrics]]
name = "ClarityCoherence"
weight = 0.34

[[metrics]]
name = "Coverage"
weight = 0.33

[[metrics]]
name = "Relevance"
weight = 0.33
```

**推奨用途**: 一般的なQ&A、ドキュメント生成

### パターン2: 正確性重視型

関連性を最も重視。

```toml
[[metrics]]
name = "Relevance"
weight = 0.5

[[metrics]]
name = "ClarityCoherence"
weight = 0.3

[[metrics]]
name = "Coverage"
weight = 0.2
```

**推奨用途**: カスタマーサポート、FAQ、検索

### パターン3: 網羅性重視型

カバレッジを最も重視。

```toml
[[metrics]]
name = "Coverage"
weight = 0.5

[[metrics]]
name = "ClarityCoherence"
weight = 0.3

[[metrics]]
name = "Relevance"
weight = 0.2
```

**推奨用途**: リサーチ、調査レポート、技術文書

### パターン4: 品質重視型

明確性と一貫性を最も重視。

```toml
[[metrics]]
name = "ClarityCoherence"
weight = 0.5

[[metrics]]
name = "Relevance"
weight = 0.3

[[metrics]]
name = "Coverage"
weight = 0.2
```

**推奨用途**: 公式文書、プレゼン資料、教育コンテンツ

### パターン5: 専門評価型（LLMPlain使用）

カスタム評価基準を含む構成。

```toml
[[metrics]]
name = "Relevance"
weight = 0.3

[[metrics]]
name = "ClarityCoherence"
weight = 0.3

[[metrics]]
name = "LLMPlain"
weight = 0.4
system_instruction = """
ドメイン固有の品質基準で評価してください:
[カスタム評価基準をここに記述]
"""
```

**推奨用途**: セキュリティレビュー、コンプライアンスチェック、専門分野評価

---

## カスタムメトリクス

標準メトリクスに加えて、`system_instruction`でカスタム評価基準を定義できます:

```toml
[[metrics]]
name = "ClarityCoherence"
weight = 0.5
system_instruction = """
技術文書としての品質を評価してください:
1. 専門用語の正確な使用
2. コード例の適切性
3. 手順の明確さ
4. トラブルシューティング情報の有無
"""
temperature = 0.0
```

---

## 評価フロー

```
┌─────────────────────────────────────────────┐
│              Submission                      │
│         (チームが生成した回答)               │
└─────────────────────────────────────────────┘
                     │
                     ▼
┌─────────────────────────────────────────────┐
│            Evaluator Process                 │
│                                              │
│  ┌───────────────┐ ┌───────────────┐       │
│  │ClarityCoherence│ │   Coverage    │       │
│  │   Score: 85   │ │   Score: 78   │       │
│  │  Weight: 0.34 │ │  Weight: 0.33 │       │
│  └───────────────┘ └───────────────┘       │
│                                              │
│  ┌───────────────┐                          │
│  │   Relevance   │                          │
│  │   Score: 92   │                          │
│  │  Weight: 0.33 │                          │
│  └───────────────┘                          │
│                                              │
│  Weighted Score = 85×0.34 + 78×0.33 + 92×0.33│
│                 = 28.9 + 25.7 + 30.4        │
│                 = 85.0                       │
└─────────────────────────────────────────────┘
                     │
                     ▼
              Final Score: 85.0
```
